<%- include('partials/head', { page: 'profile' }) %>

<div class="profile min-h-screen flex flex-col items-center py-10 px-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">

  <!-- Profile Card -->
  <div class="relative rounded-2xl shadow-2xl p-8 w-full md:w-2/3 lg:w-1/2 flex flex-col items-center gap-6"
       style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);">

    <!-- Back Button -->
    <button onclick="window.location.href='/dashboard'" class="absolute top-4 left-4 text-white hover:text-gray-300 transition text-2xl">
      ⬅️
    </button>

    <!-- Profile Image -->
    <div class="relative">
      <div class="w-28 h-28 md:w-32 md:h-32 rounded-full overflow-hidden border-2 border-white/30 shadow-lg">
        <img src="/images/uploads/<%= user.profileImage ? user.profileImage : 'default.png' %>" alt="Profile" class="w-full h-full object-cover rounded-full">
      </div>
      <!-- Floating Pencil Icon -->
      <span id="uploadIcon" class="absolute -bottom-1 -right-1 w-9 h-9 bg-indigo-500 rounded-full flex items-center justify-center text-white text-lg border-2 border-white shadow-lg cursor-pointer hover:bg-indigo-400 transition">
        <i class="ri-pencil-line">✏️</i>
      </span>
    </div>

    <!-- User Info -->
    <div class="flex flex-col items-center gap-2 mt-4 text-center">
      <h1 class="text-2xl md:text-3xl font-bold text-white"><%= user.name %></h1>
      <h3 class="text-sm md:text-md text-gray-200"><%= user.username %></h3>
      <p class="text-gray-300 text-sm md:text-md"><%= user.email %></p>
    </div>

    <!-- Stats -->
    <div class="flex gap-6 mt-4 flex-wrap justify-center">
      <div class="flex flex-col items-center bg-white/10 backdrop-blur-sm px-5 py-3 rounded-xl shadow-md">
        <p class="text-white font-bold text-lg"><%= user.conferences ? user.conferences.length : 0 %></p>
        <p class="text-gray-200 text-sm">Conferences</p>
      </div>
      <div class="flex flex-col items-center bg-white/10 backdrop-blur-sm px-5 py-3 rounded-xl shadow-md">
        <p class="text-white font-bold text-lg"><%= user.speakers ? user.speakers.length : 0 %></p>
        <p class="text-gray-200 text-sm">Speakers</p>
      </div>
      <div class="flex flex-col items-center bg-white/10 backdrop-blur-sm px-5 py-3 rounded-xl shadow-md">
        <p class="text-white font-bold text-lg"><%= user.attendees ? user.attendees.length : 0 %></p>
        <p class="text-gray-200 text-sm">Attendees</p>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex gap-4 mt-6 flex-wrap justify-center">
      <a href="/profile/edit" class="px-6 py-2 rounded-full bg-gradient-to-r from-indigo-500 to-blue-500 hover:from-indigo-400 hover:to-blue-400 text-white font-semibold transition">Edit Profile</a>
      <a href="/create-conference" class="px-6 py-2 rounded-full bg-gradient-to-r from-pink-500 to-violet-500 hover:from-pink-400 hover:to-violet-400 text-white font-semibold transition">Add Conference</a>
    </div>

  </div>

  <!-- Recent Activity -->
  <div class="mt-10 w-full md:w-2/3 lg:w-1/2">
    <h3 class="text-white text-2xl font-semibold mb-4">Recent Activity</h3>
    <div class="grid gap-4">
      <% if(user.recentActivities && user.recentActivities.length > 0) { %>
        <% user.recentActivities.forEach(function(activity){ %>
          <div class="bg-white/10 backdrop-blur-sm border border-white/20 rounded-xl p-4 text-gray-100 hover:scale-105 transition">
            <p><span class="text-white font-semibold"><%= activity.title %></span> - <%= activity.description %></p>
            <span class="text-gray-300 text-sm block mt-1"><%= activity.timeAgo %></span>
          </div>
        <% }) %>
      <% } else { %>
        <p class="text-gray-300">No recent activity.</p>
      <% } %>
    </div>
  </div>

</div>

<!-- Profile Image Upload Form -->
<form id="uploadForm" hidden action="/upload-profile" method="POST" enctype="multipart/form-data">
  <input id="fileInput" type="file" name="profileImage" accept="image/*">
</form>

<script>
  const uploadIcon = document.getElementById('uploadIcon');
  const fileInput = document.getElementById('fileInput');
  const uploadForm = document.getElementById('uploadForm');

  uploadIcon.addEventListener('click', () => fileInput.click());
  fileInput.addEventListener('change', () => uploadForm.submit());
</script>

<%- include('partials/footer', { page: 'profile' }) %>
